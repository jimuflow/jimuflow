# 表达式

在指令的配置中，我们经常需要使用表达式，其语法类似数学表达式，但是它比数学表达式更强大。

我们可以使用表达式来实现数学运算、字符串操作、比较判断、访问变量及其属性。

表达式由字面量、变量、操作符组成。

下面是一些常用的表达式示例：

![expression_demo_string_operate.png](expression_demo_string_operate.png)

上面这个表达式将字符串"你好，"与变量"名字"连接成字符串，如果名字是"小明"，那么表达式的结果就是"你好，小明"。

![expression_demo_math.png](expression_demo_math.png)

上面这个表达式将收入减去100，然后再乘以0.1，如果收入是10000，那么表达式的结果就是990。

![expression_demo_logic.png](expression_demo_logic.png)

上面这个表达式判断收入是否大于6000且小于10000。

![expression_demo_array.png](expression_demo_array.png)

上面这个表达式用于获取列表中的第一个值。

![expression_demo_dict.png](expression_demo_dict.png)

上面这个表达式用于获取字典中name键的值。

![expression_demo_dot.png](expression_demo_dot.png) 

上面这个表达式用于获取名字的长度。

## 字面量

直接在表达式中输入的值称为字面量，当前有三种字面量，字符串，数字和布尔值。

字符串字面量由任意字符组成，如"abc123"。

数字字面量支持小数和整数，如3.14，100，-3.14，-100。

布尔值字面量有true和false，true表示真或条件成立，false表示假或条件不成立。

## 变量

在表达式中可以通过变量名访问变量中保存的值，变量名必须以字母、汉字、下划线开头，后面可以跟字母、汉字、数字或下划线。

在表达式中除了可以直接访问变量的值，还可以通过属性访问操作符访问变量的属性，变量具有哪些属性由变量的类型决定。

### 文本类型 - text

文本是由任意字符组成的字符串，文本变量具有如下属性：

- length：获取文本的长度。
- lower：获取转为小写的文本。
- upper：获取转为大写的文本。

### 数值类型 - number

数值类型可以表示整数或小数，数值变量具有如下属性：

- round：获取四舍五入后的整数。
- floor：获取向下取整后的整数。
- ceil：获取向上取整后的整数。
- abs：获取绝对值。

### 布尔类型 - bool

布尔类型只有true和false，布尔变量没有属性。

### 列表类型 - list

列表是有序的元素集合，列表变量具有如下属性：

- size：获取列表中的元素个数。

### 字典类型 - dict

字典是无序的键值对集合，字典变量具有如下属性：

- size：获取字典中的键值对个数。
- keys：获取字典中的所有键组成的列表。
- values：获取字典中的所有值组成的列表。
- items：获取字典中的所有键值对组成的列表。

### 数据表格类型 - table

数据表格是表格数据，数据表格变量具有如下属性：

- numberOfRows：获取表格中的数据行数，不包含表头。
- numberOfColumns：获取表格中的数据列数。
- columnNames：获取表头中的所有列名组成的列表。
- rows：获取表格中的所有数据行组成的列表。

### 日期类型 - date

日期类型用来表示一个年月日日期，日期变量具有如下属性：

- year：获取年份。
- month：获取月份。
- day：获取日。

### 时间类型 - time

时间类型用来表示一个时分秒时间，时间变量具有如下属性：

- hour：获取小时。
- minute：获取分钟。
- second：获取秒。
- microsecond：获取微秒。

### 日期时间类型 - datetime

日期时间类型用来表示一个年月日时分秒时间，日期时间变量具有如下属性：

- date：获取日期部分，日期类型。
- time：获取时间部分，时间类型。
- year：获取年份。
- month：获取月份。
- day：获取日。
- hour：获取小时。
- minute：获取分钟。
- second：获取秒。
- microsecond：获取微秒。
- timestamp：获取时间戳，单位为秒。

### 文件路径信息类型 - FilePathInfo

文件路径信息类型包含了文件路径相关的信息，文件路径信息变量具有如下属性：

* root：根目录
* parent：父目录
* name：文件名
* nameWithoutExtension：不带扩展名的文件名
* extension：文件扩展名
* exists：文件是否存在
* isDirectory：是否为文件夹
* isFile：是否为文件
* size：文件大小，单位字节
* ctime：创建时间，是一个时间戳，单位秒
* mtime：修改时间，是一个时间戳，单位秒

### 网页浏览器类型 - WebBrowser

网页浏览器类型代表了一个打开的网页浏览器对象。

### 网页类型 - WebPage

网页类型代表了一个打开的网页对象，网页变量具有如下属性：

- url：获取网页的url地址。

### 网页元素类型 - WebElement

网页元素类型代表了一个网页元素对象，如按钮、链接等。

### 窗口元素类型 - WindowElement

窗口元素类型代表了一个窗口对象或窗口中元素对象。

## 操作符

| 操作符名称 | 操作符  | 优先级 | 说明                                           |
|-------|------|-----|----------------------------------------------|
| 逻辑或   | \|\| | 1   | 逻辑运算，当左右两个操作数有一个为true时返回true，否则返回false。      |  
| 逻辑与   | &&   | 2   | 逻辑运算，当左右两个操作数均为true时返回true，否则返回false。        |  
| 相等    | ==   | 3   | 比较运算，当左右两个操作数相等时返回true，否则返回false。            |   
| 不相等   | !=   | 3   | 比较运算，当左右两个操作数不相等时返回true，否则返回false。           |   
| 大于    | \>   | 4   | 比较运算，当左边操作数大于右边操作数时返回true，否则返回false。         |  
| 大于等于  | \>=  | 4   | 比较运算，当左边操作数大于等于右边操作数时返回true，否则返回false。       |  
| 小于    | \<   | 4   | 比较运算，当左边操作数小于右边操作数时返回true，否则返回false。         | 
| 小于等于  | \<=  | 4   | 比较运算，当左边操作数小于等于右边操作数时返回true，否则返回false。       |
| 加号    | +    | 5   | 数学加法运算                                       |
| 减号    | -    | 5   | 数学减法运算                                       |
| 乘号    | *    | 6   | 数学乘法运算                                       |
| 除号    | /    | 6   | 数学除法运算                                       |
| 取余    | %    | 6   | 数学取余运算                                       |
| 幂    | **    | 6   | 数学幂运算，返回x的y次幂，如10**2表示10的2次方，返回100           |
| 取整除    | //    | 6   | 数学取整除运算 - 返回商的整数部分（向下取整）,如9//2返回4，-9//2返回-5。 |
| 逻辑非   | !    | 7   | 逻辑运算，将布尔值取反， true变成false，false变成true。        |   
| 取负    | -    | 7   | 数学取负运算，正数变成负数，负数变成正数。                        |
| 索引访问  | []   | 8   | 访问列表元素或字典键值。                                 |   
| 属性访问  | .    | 8   | 访问对象属性。                                      |   
| 括号    | ()   | 9   | 优先计算括号内的表达式。                                 |


优先级高的运算符优先于优先级低的运算符执行，如果两个优先级相同，则从左到右依次执行。

如果括号内还有括号，则优先计算括号内的表达式。

当不确定运算符优先级时，可以使用括号明确指定运算符的优先级。
